# HOR detection
This script using De Bruijn graph visualize HOR-SFs(High order repeat of sub families) connections for dimer-compressed monomer sequences of centromeres.
## Requirments:
    Python 3.7+
    networkx
    pygraphviz
    r-argprase
    r-dplyr
    r-stringi
    
## Usage
#### For whole chromosome , use this pipeline :  
` bash HORdetect.sh -s -i data/Zpal_CentZp_subfamily.csv -b data/Zpal_dimer_sf_HOR.bed -f data/Zpal_dimer_sf_sequences.fa `

  -i : your input csv file (format showed in data/ , this csv can be generated by 02.2.subfamily_data_preprocessing.ipynb)  
  -b -f (custom): output file path and your custom name
  
#### Or, you can use this to sololy run for distinct chromosome(accession) , but need to generate input file by 06.HOR.r(06.HOR.ipynb) yourself :
``` python HORdetect.py -fi Zpal_dimer_sf_sequences.fa -pos Zpal_dimer_sf_HOR.bed -p Chr01 -O . ```

-fi -pos : input file can be read in data/ . This file can be generated in 06.HOR.ipynb(06.HOR.r)
## Used code :
 This script includes some code from HORmon(https://github.com/ablab/HORmon) and HORdetection for Rice(https://github.com/dongyawu/CenTools/tree/main/HOR)

- BuildMonomerGraph & drawGraph: build monomer graph and visualization
- genAllCycles & genCycleInner ï¼šget initial cycles
- HORdetect_rice.py

